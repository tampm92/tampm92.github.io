[{},{"slug":"github-action-pull-and-push-external-private-repository","path":"/en/github/github-action-pull-and-push-external-private-repository","section":"github","doc":{"attrs":{"imgUrl":"https://live.staticflickr.com/65535/49843305938_30e7afd0b4_b.jpg","authors":[{"name":"Tam Phan","avatarUrl":"https://live.staticflickr.com/65535/49843962042_1d80277b1b_t.jpg","link":"https://twitter.com/tamphan1992"}],"name":"Github","title":"Github-Action pull and push external private repository","description":"Github-Action pull and push external private repository","date":"2020-05-03T00:00:00.000Z","tags":["github-action","build nodejs","deploy github-page","private repo","git-pull","git-push"]},"body":"<h2 id=\"referents\"><a class=\"anchor\" aria-hidden=\"true\" href=\"#referents\"><svg version=\"1.1\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" class=\"octicon octicon-link\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Referents</h2><ul>\n<li>TP - Github Action: <a href=\"/tamy/github-action\">github-action</a></li>\n<li>For checkout/clone repo: <a href=\"https://github.com/actions/checkout\">actions/checkout</a></li>\n<li>For push repo <a href=\"https://github.com/peaceiris/actions-gh-pages\">peaceiris/actions-gh-pages</a></li>\n</ul>\n<h2 id=\"full-github-workflow\"><a class=\"anchor\" aria-hidden=\"true\" href=\"#full-github-workflow\"><svg version=\"1.1\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" class=\"octicon octicon-link\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Full github workflow</h2><pre><code class=\"hljs yml\"><span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">GitPage</span>\n\n<span class=\"hljs-attr\">on:</span>\n  <span class=\"hljs-attr\">push:</span>\n    <span class=\"hljs-attr\">branches:</span> <span class=\"hljs-string\">[</span> <span class=\"hljs-string\">master</span> <span class=\"hljs-string\">]</span>\n  <span class=\"hljs-attr\">pull_request:</span>\n    <span class=\"hljs-attr\">branches:</span> <span class=\"hljs-string\">[</span> <span class=\"hljs-string\">master</span> <span class=\"hljs-string\">]</span>\n\n<span class=\"hljs-attr\">jobs:</span>\n  <span class=\"hljs-attr\">deploy:</span>\n    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span>\n    <span class=\"hljs-attr\">strategy:</span>\n      <span class=\"hljs-attr\">matrix:</span>\n        <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-string\">[12.x]</span>\n    <span class=\"hljs-attr\">steps:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">main</span> <span class=\"hljs-string\">repo</span> <span class=\"hljs-string\">üõéÔ∏è</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">external</span> <span class=\"hljs-string\">repo</span> <span class=\"hljs-string\">üõéÔ∏è</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">repository:</span> <span class=\"hljs-string\">other-org/other-repo-clone</span>\n        <span class=\"hljs-attr\">token:</span> <span class=\"hljs-string\">${{</span> <span class=\"hljs-string\">secrets.PERSONAL_TOKEN</span> <span class=\"hljs-string\">}}</span> <span class=\"hljs-comment\"># permission to access to external repositories</span>\n        <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">other-repo</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Use</span> <span class=\"hljs-string\">Node.js</span> <span class=\"hljs-string\">${{</span> <span class=\"hljs-string\">matrix.node-version</span> <span class=\"hljs-string\">}}</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-node@v1</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-string\">${{</span> <span class=\"hljs-string\">matrix.node-version</span> <span class=\"hljs-string\">}}</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">install</span> <span class=\"hljs-string\">dependencies</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">yarn</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">build...</span>\n      <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">yarn</span> <span class=\"hljs-string\">build</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">üöÄ</span>\n      <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">peaceiris/actions-gh-pages@v3</span>\n      <span class=\"hljs-attr\">with:</span>\n        <span class=\"hljs-attr\">personal_token:</span> <span class=\"hljs-string\">${{</span> <span class=\"hljs-string\">secrets.PERSONAL_TOKEN</span> <span class=\"hljs-string\">}}</span> <span class=\"hljs-comment\"># permission to access to external repositories</span>\n        <span class=\"hljs-attr\">external_repository:</span> <span class=\"hljs-string\">other-org/other-repo-deploy</span>\n        <span class=\"hljs-attr\">publish_branch:</span> <span class=\"hljs-string\">master</span> <span class=\"hljs-comment\"># A target branch to deploy</span>\n        <span class=\"hljs-attr\">publish_dir:</span> <span class=\"hljs-string\">./dist</span> <span class=\"hljs-comment\"># A target directory to deploy</span></code></pre><h2 id=\"explaining-example\"><a class=\"anchor\" aria-hidden=\"true\" href=\"#explaining-example\"><svg version=\"1.1\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" class=\"octicon octicon-link\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"/></svg></a>Explaining example</h2><p><code>name: Deploy GitPage</code>: descriptive workflow name</p>\n<p><code>on</code>: setup GitHub event that triggers the workflow.</p>\n<p><code>jobs:</code>: define jobs run when Github event is happened (Here example is you <code>push</code> or pull <code>request</code>)</p>\n<p><code>jobs.deploy</code>: <code>deploy</code> is job id</p>\n<p><code>runs-on: ubuntu-latest</code>: the type of machine to run the job on.</p>\n<p><code>steps</code>: a job contains a sequence of tasks called steps.</p>\n<p><code>Checkout</code>: Clone repo (<a href=\"https://github.com/actions/checkout\">doc</a>)</p>\n<ul>\n<li>Checkout current repo</li>\n</ul>\n<pre><code class=\"hljs yml\"><span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">main</span> <span class=\"hljs-string\">repo</span> <span class=\"hljs-string\">üõéÔ∏è</span>\n  <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span></code></pre><ul>\n<li>Checkout external repo</li>\n</ul>\n<pre><code class=\"hljs yml\"><span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">external</span> <span class=\"hljs-string\">repo</span> <span class=\"hljs-string\">üõéÔ∏è</span>\n  <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span>\n  <span class=\"hljs-attr\">with:</span>\n    <span class=\"hljs-attr\">repository:</span> <span class=\"hljs-string\">other-org/other-repo-clone</span>\n    <span class=\"hljs-attr\">token:</span> <span class=\"hljs-string\">${{</span> <span class=\"hljs-string\">secrets.PERSONAL_TOKEN</span> <span class=\"hljs-string\">}}</span> <span class=\"hljs-comment\"># permission to access to external repositories</span>\n    <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">other-repo</span></code></pre><p><code>Runs command-line</code> programs using the operating system&#39;s shell. (Example here is install dependencies and build by yarn)</p>\n<pre><code class=\"hljs yml\"><span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">install</span> <span class=\"hljs-string\">dependencies</span>\n  <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">yarn</span>\n<span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">build...</span>\n  <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">yarn</span> <span class=\"hljs-string\">build</span></code></pre><p><code>Deploy</code>: push external repo (<a href=\"https://github.com/peaceiris/actions-gh-pages\">doc</a>)</p>\n<pre><code class=\"hljs yml\"><span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">üöÄ</span>\n  <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">peaceiris/actions-gh-pages@v3</span>\n  <span class=\"hljs-attr\">with:</span>\n    <span class=\"hljs-attr\">personal_token:</span> <span class=\"hljs-string\">${{</span> <span class=\"hljs-string\">secrets.PERSONAL_TOKEN</span> <span class=\"hljs-string\">}}</span> <span class=\"hljs-comment\"># permission to access to external repositories</span>\n    <span class=\"hljs-attr\">external_repository:</span> <span class=\"hljs-string\">other-org/other-repo-deploy</span>\n    <span class=\"hljs-attr\">publish_branch:</span> <span class=\"hljs-string\">master</span> <span class=\"hljs-comment\"># A target branch to deploy</span>\n    <span class=\"hljs-attr\">publish_dir:</span> <span class=\"hljs-string\">./dist</span> <span class=\"hljs-comment\"># A target directory to deploy</span></code></pre><p><code>PERSONAL_TOKEN</code>: you need permission to pull/push other repo</p>\n<ul>\n<li>Generate a personal access token (<a href=\"https://github.com/settings/tokens\">here</a>).</li>\n<li>Add it to Secrets as <code>PERSONAL_TOKEN</code></li>\n</ul>\n<pre><code class=\"hljs txt\">1. On GitHub, navigate to the main page of the repository.\n2. Under your repository name, click  Settings.\n3. In the left sidebar, click Secrets.\n4. Type a name for your secret in the `PERSONAL_TOKEN` input box.\n5. Type the value for your secret.\n6. Click Add secret.</code></pre>"}}]